<div class="login">
  <div class="login__card">
    <h1>{{ 'login.title' | translate }}</h1>
    <p>{{ 'login.subtitle' | translate }}</p>

    <form *ngIf="step() === 1" (ngSubmit)="requestCode()" class="login__form">
      <label>
        <span>{{ 'login.phone' | translate }}</span>
        <div class="login__phone-group">
          <select
            [ngModel]="selectedCountryIso"
            (ngModelChange)="onCountryChange($event)"
            name="country"
            required
          >
            <option *ngFor="let country of countries" [value]="country.iso">
              {{ country.label }} ({{ country.dialCode }})
            </option>
          </select>

          <input
            type="tel"
            inputmode="numeric"
            autocomplete="tel-national"
            placeholder="11XXXXXXXX"
            [ngModel]="phoneNumber"
            (ngModelChange)="onPhoneInput($event)"
            name="phone"
            required
          />
        </div>
      </label>

      <button type="submit" [disabled]="isLoading() || !phoneNumber">
        {{ isLoading() ? ('login.loading' | translate) : ('login.sendCode' | translate) }}
      </button>
    </form>

    <form *ngIf="step() === 2" (ngSubmit)="verifyCode()" class="login__form">
      <label>
        <span>{{ 'login.code' | translate }}</span>
        <input
          type="text"
          inputmode="numeric"
          autocomplete="one-time-code"
          maxlength="6"
          [ngModel]="code"
          (ngModelChange)="onCodeInput($event)"
          name="code"
          required
        />
      </label>

      <button type="submit" [disabled]="isLoading() || code.length !== 6">
        {{ isLoading() ? ('login.loading' | translate) : ('login.verify' | translate) }}
      </button>
    </form>

    <p class="login__error" *ngIf="errorMessage()">{{ errorMessage()! | translate }}</p>
  </div>
</div>
